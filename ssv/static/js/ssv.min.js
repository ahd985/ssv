!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.ssv=t()}}(function(){return function t(e,i,n){function r(s,o){if(!i[s]){if(!e[s]){var l="function"==typeof require&&require;if(!o&&l)return l(s,!0);if(a)return a(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var d=i[s]={exports:{}};e[s][0].call(d.exports,function(t){var i=e[s][1][t];return r(i?i:t)},d,d.exports,t,e,i,n)}return i[s].exports}for(var a="function"==typeof require&&require,s=0;s<n.length;s++)r(n[s]);return r}({1:[function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=t("./ssv_utilities.es6"),s=function(){function t(e,i,r,a,s,o){n(this,t),this.uuid=e,this.title=i,this.x_series=r,this.x_series_unit=a,this.update_callback=s,this.context=o,this.play_enabled=!1,this.pan_zoom_enabled=!1,this.slider_moving=!1,this.current_x=0,this.target_x=0,this.play_speed=1,this.max_speed=8,this.min_speed=1,this.speed_mult=2,this.bbox_zoom=null,this.title_sel=d3.select("#"+this.uuid+" #title"),this.x_val_sel=d3.select("#"+this.uuid+" #x-series-val"),this.x_val_unit_sel=d3.select("#"+this.uuid+" #x-series-unit"),this.svg_container_sel=d3.select("#"+this.uuid+" .svg-container"),this.svg_sel=d3.select("#"+this.uuid+" #ssv-svg"),this.img_sel=d3.select("#"+this.uuid+" #img-space"),this.render_sel=d3.select("#"+this.uuid+" #render-space"),this.zoom_layer_sel=d3.select("#"+this.uuid+" #zoom-layer"),this.info_layer_sel=d3.select("#"+this.uuid+" #info-layer"),this.speed_btn_sel=d3.select("#"+this.uuid+" #speed-button"),this.play_btn_sel=d3.select("#"+this.uuid+" #play-button"),this.pan_zoom_btn_sel=d3.select("#"+this.uuid+" #pan-zoom-button"),this.center_btn_sel=d3.select("#"+this.uuid+" #center-button"),this.save_btn_sel=d3.select("#"+this.uuid+" #save-button"),this.vid_btn_sel=d3.select("#"+this.uuid+" #video-button"),this.modebar_sel=d3.select("#"+this.uuid+" .modebar"),this.modebar_group_sel=d3.select("#"+this.uuid+" .modebar-group"),this.modebar_slider_sel=d3.select("#"+this.uuid+" .modebar-slider"),this.pause_icon_sel=d3.select("#"+this.uuid+" #pause-icon"),this.play_icon_sel=d3.select("#"+this.uuid+" #play-icon"),this.pan_zoom_enabled_icon_sel=d3.select("#"+this.uuid+" #pan-zoom-enabled-icon"),this.pan_zoom_disabled_icon_sel=d3.select("#"+this.uuid+" #pan-zoom-disabled-icon"),this.initialize()}return r(t,[{key:"render_slider",value:function(){var t=this.modebar_sel.node().getBoundingClientRect(),e=t.height,i=2,n=8,r=t.width-this.modebar_group_sel.node().getBoundingClientRect().width,a=d3.scaleLinear().domain([0,this.x_series.length-1]).range([0,r-2*(i+n)]).clamp(!0);this.modebar_slider_sel.selectAll("svg").remove();var s=this.modebar_slider_sel.append("svg").attr("width",r).append("g").attr("transform","translate("+(n+i).toString()+","+(e/2+i).toString()+")"),o=this;s.append("line").attr("class","slider-track").attr("x1",a.range()[0]).attr("x2",a.range()[1]).select(function(){return this.parentNode.appendChild(this.cloneNode(!0))}).attr("class","slider-inset").select(function(){return this.parentNode.appendChild(this.cloneNode(!0))}).attr("class","slider-overlay").call(d3.drag().on("start.interrupt",function(){s.interrupt()}).on("start drag",function(){o.target_x=Math.round(a.invert(d3.event.x)),o.move(250)}));var l=s.append("circle").attr("class","slider-handle").attr("r",n);this.slider_dispatch=d3.dispatch("change"),this.slider_dispatch.on("change",function(){l.attr("cx",a(o.target_x))})}},{key:"play",value:function(){this.play_enabled?(this.play_enabled=!1,this.pause_icon_sel.attr("style","display:none"),this.play_icon_sel.attr("style","")):(this.play_enabled=!0,this.pause_icon_sel.attr("style",""),this.play_icon_sel.attr("style","display:none"),this.current_x>=this.x_series.length-1&&(this.current_x=0),this.x_series_forward())}},{key:"toggle_pan_zoom",value:function(){this.pan_zoom_enabled?(this.pan_zoom_enabled=!1,this.pan_zoom_disabled_icon_sel.attr("style",""),this.pan_zoom_enabled_icon_sel.attr("style","display:none")):(this.pan_zoom_enabled=!0,this.pan_zoom_disabled_icon_sel.attr("style","display:none"),this.pan_zoom_enabled_icon_sel.attr("style",""))}},{key:"move",value:function(t){if(this.slider_dispatch.call("change"),this.set_x_series_display(this.current_x),!this.slider_moving){this.slider_moving=!0,this.current_x=this.target_x,this.update_callback.call(this.context,this.current_x,t);var e=this;d3.timer(function(){e.slider_moving=!1},500)}}},{key:"x_series_forward",value:function(){var t=this;window.setTimeout(function(){t.play_enabled&&t.current_x<t.x_series.length-1&&(t.target_x=t.current_x+1,t.move(250),t.current_x<t.x_series.length-1?t.x_series_forward():t.play())},1e3/this.play_speed)}},{key:"set_x_series_display",value:function(t){this.x_val_sel.html(a.num_format(this.x_series[t]))}},{key:"initialize",value:function(){this.render_slider(),this.update_viewbox(),this.title_sel.html(this.title),this.set_x_series_display(0),this.x_val_unit_sel.html(this.x_series_unit);var t=this;d3.select(window).on("resize",function(){t.render_slider(),t.update_viewbox()}),this.play_btn_sel.attr("ssv-id",this.uuid).on("click",function(){t.play()}),this.pan_zoom_btn_sel.attr("ssv-id",this.uuid).on("click",function(){t.toggle_pan_zoom()}),this.speed_btn_sel.attr("ssv-id",this.uuid).on("click",function(){t.play_speed==t.max_speed?t.play_speed=t.min_speed:t.play_speed*=t.speed_mult;var e=t.play_speed.toString();t.speed_btn_sel.select("span").html("<b>"+e+"x</b>")}),this.initialize_pan_zoom(),this.save_btn_sel.attr("ssv-id",this.uuid).on("click",function(){t.to_image()}),this.vid_btn_sel.attr("ssv-id",this.uuid).on("click",function(){t.to_video()})}},{key:"initialize_pan_zoom",value:function(){var t=this.info_layer_sel.node().getBBox(),e=[t.x,t.y],i=this,n=d3.zoom().scaleExtent([1,8]).on("zoom",function(){if(i.pan_zoom_enabled){var n=d3.event.transform.k,r=0,a=0;t.width*n<=i.bbox_zoom.width?(r=Math.max(d3.event.transform.x,i.bbox_zoom.x-t.x-e[0]*(n-1)),r=Math.min(r,i.bbox_zoom.width-(t.x-i.bbox_zoom.x+e[0]*(n-1))-t.width*n)):(r=Math.max(d3.event.transform.x,i.bbox_zoom.x-t.x-(t.width*n-i.bbox_zoom.width)-e[0]*(n-1)),r=Math.min(r,t.x-e[0]*(n-1)-i.bbox_zoom.x)),t.height*n<=i.bbox_zoom.height?(a=Math.max(d3.event.transform.y,i.bbox_zoom.y-t.y-e[1]*(n-1)),a=Math.min(a,i.bbox_zoom.height-(t.y-i.bbox_zoom.y+e[1]*(n-1))-t.height*n)):(a=Math.max(d3.event.transform.y,i.bbox_zoom.y-t.y-(t.height*n-i.bbox_zoom.height)-e[1]*(n-1)),a=Math.min(a,t.y-e[1]*(n-1)-i.bbox_zoom.y)),i.info_layer_sel.attr("transform","translate("+[r,a]+")scale("+n+")"),d3.event.transform.x=r,d3.event.transform.y=a}});this.svg_sel.call(n),this.center_btn_sel.attr("ssv-id",this.uuid).on("click",function(){i.info_layer_sel.attr("transform","translate("+[t.x,t.y]+")scale(1)"),n.transform(i.svg_sel,d3.zoomIdentity)})}},{key:"update_viewbox",value:function(){var t=this.svg_container_sel.node().getBoundingClientRect(),e=this.svg_sel.attr("viewBox").split(" ").map(function(t){return parseFloat(t)}),i=.05*e[3],n=e[3]/t.height,r=t.width*n-e[2];e[2]=e[2]+r,e[0]=e[0]-r/2,this.svg_sel.attr("viewBox",e.join(" ")),this.zoom_layer_sel.attr("x",e[0]+i).attr("width",e[2]-2*i).attr("y",e[1]+i).attr("height",e[3]-2*i).style("fill","none"),this.bbox_zoom=this.zoom_layer_sel.node().getBBox()}},{key:"render_slice",value:function(t,e){var i='<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">',n=(new XMLSerializer).serializeToString(this.svg_sel.node()),r=new Blob([i+n],{type:"image/svg+xml;charset=utf-8"}),a=window.URL.createObjectURL(r),s=this.svg_sel.node().getBoundingClientRect(),o=this.img_sel.attr("width",s.width).attr("height",s.height).node(),l=4,c=this.render_sel.node();c.width=s.width*l,c.height=s.height*l;var d=c.getContext("2d");d.fillStyle="white",d.fillRect(0,0,s.width*l,s.height*l),o.onload=function(){d.drawImage(o,0,0),"image"==t?e(c.toDataURL()):"video"==t&&e(c.toDataURL("image/webp"))},o.src=a}},{key:"to_image",value:function(){var t=function(t){var e=document.createElement("a"),i=a.num_format(self.x_series[self.current_x])+"_"+self.x_series_unit;e.download=self.title.replace(" ","_")+"_"+i+".jpeg",e.href=t,e.click()};this.render_slice("image",t)}},{key:"to_video",value:function(){function t(){r=i>e.frames.length,r||(e.target_x=i,e.move(0),e.set_x_series_display(i),e.render_slice("video",n),r=!0,i+=1)}var e=this;e.frames=[];var i=0,n=function(t){e.frames.push(t)},r=!1,a=setInterval(function(){if(i<e.x_series.length)t();else{var n=Whammy.fromImageArray(e.frames,15),r=window.URL.createObjectURL(n),s=document.createElement("a");s.download=e.title.replace(" ","_")+".webm",s.href=r,s.click(),clearInterval(a)}},100)}}]),t}();e.exports=function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return new(Function.prototype.bind.apply(s,[null].concat(e)))}},{"./ssv_utilities.es6":5}],2:[function(t,e,i){"use strict";function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e,i){return new v[e.type](t,e.ids,e.description,e.conditions,e.report_id,e.popover,i)}var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l=t("./ssv_renderers.es6"),c=function(){function t(e,i,n,r,s,o,l){a(this,t),this.uuid=e,this.selectors=[],i&&(this.ids=i,this.selectors=i.map(function(t){return d3.select("#"+e+" #"+t)})),this.update_functions=[],this.report_sel=d3.select("#"+e+" #"+s),this.popover_div_sel=d3.select("#"+e+" .popover-spacer"),this.description=n,this.conditions=r,this.popover=o,this.font_scale=l,this.patterns_initialized=!1,this.gen_color_scales(),this.initialize()}return o(t,[{key:"gen_color_scales",value:function(){this.conditions.map(function(t){if("color_scale"in t&&"color_levels"in t){var e=t.color_scale,i=t.color_levels;t.color_scale=d3.scaleQuantile().domain([d3.min(i),d3.max(i)]).range(e)}})}},{key:"initialize",value:function(){this.report_sel.empty()||this.update_functions.push(l.render_report(this.report_sel.node(),this.font_scale,this.conditions,this.description)),this.popover&&this.update_functions.push(l.render_popover(this.popover_div_sel,this.selectors,this.popover,this.font_scale)),this.initialize_hook(),delete this.conditions}},{key:"initialize_hook",value:function(){}},{key:"update",value:function(t){this.update_functions&&this.update_functions.map(function(e){"function"==typeof e&&e(t)})}}]),t}(),d=function(t){function e(){return a(this,e),n(this,Object.getPrototypeOf(e).apply(this,arguments))}return r(e,t),o(e,[{key:"initialize_hook",value:function(){var t=this;t.selectors.map(function(e,i){var n="pattern_"+t.ids[i];if(!t.patterns_initialized){var r=[];t.conditions.map(function(t){var e,i=1.01;if(e="overlay"in t?t.overlay:null,"background"==t.type)r.push(t.data.map(function(n){return[i,t.color_scale(n),t.opacity,e]}));else if("levelstatic"==t.type)r.push(t.data.map(function(i){var n=(Math.min((i-t.min_height)/(t.max_height-t.min_height)),1);return[n,t.color,t.opacity,e]}));else if("dynamiclevel"==t.type)r.push(t.data.map(function(i,n){var r=Math.min((i-t.min_height)/(t.max_height-t.min_height),1),a=t.color_scale(t.data_dynamic[n]);return[r,a,t.opacity,e]}));else if("logical"==t.type)r.push(t.data.map(function(n){var r;return r=n?t.true_color:t.false_color,[i,r,t.opacity,e]}));else if("zonaly"==t.type){var n=[];n=n.concat(t.data.map(function(i,n){return i.map(function(i,r){var a=Math.min((i-t.min_height)/(t.max_height-t.min_height),1),s=t.color_scale(t.data_dynamic[n][r]);return[a,s,t.opacity,e]})})),r=r.concat(d3.zip.apply(this,n))}}),r=d3.zip.apply(this,r),e.each(function(){t.update_functions.push(l.render_pattern(this,n,r,"fill"))})}})}}]),e}(c),u=function(t){function e(){return a(this,e),n(this,Object.getPrototypeOf(e).apply(this,arguments))}return r(e,t),o(e,[{key:"initialize_hook",value:function(){var t=this;t.selectors.map(function(e,i){var n="pattern_"+t.ids[i],r=[];t.patterns_initialized||(t.conditions.map(function(t){var e,e=(t.opacity,null);if("equaly"==t.type){var i=[],i=i.concat(t.data.map(function(i){return i.map(function(n,r){var a=r/i.length,s=t.color_scale(n);return[a,s,t.opacity,e]})}));r=r.concat(d3.zip.apply(this,i))}}),r=d3.zip.apply(this,r),e.each(function(){t.update_functions.push(l.render_pattern(this,n,r,"stroke"))}))})}}]),e}(c),h=function(t){function e(){return a(this,e),n(this,Object.getPrototypeOf(e).apply(this,arguments))}return r(e,t),o(e,[{key:"initialize_hook",value:function(){var t=this.conditions[0].data,e=this.conditions[0].color_scale,i=this.opacity,n=this;n.selectors.map(function(r){r.each(function(){n.update_functions.push(l.render_rect_heatmap(this,t,e,i))})})}}]),e}(c),p=function(t){function e(){return a(this,e),n(this,Object.getPrototypeOf(e).apply(this,arguments))}return r(e,t),o(e,[{key:"initialize_hook",value:function(){var t=this;t.selectors.map(function(e){if("showhide"==t.conditions[0].type){var i=t.conditions[0].data;e.datum(i);var n=function(t){i[t]||i[t]>0?e.transition().attr("opacity",1):e.transition().attr("opacity",0)};t.update_functions.push(n)}})}}]),e}(c),f=function(t){function e(){return a(this,e),n(this,Object.getPrototypeOf(e).apply(this,arguments))}return r(e,t),e}(c),_=function(t){function e(){return a(this,e),n(this,Object.getPrototypeOf(e).apply(this,arguments))}return r(e,t),o(e,[{key:"initialize",value:function(){var t=this.report_sel.node(),e="table_"+this.report_id,i=this.conditions[0].data,n=this.conditions[0].headers;this.update_functions.push(l.render_table(t,e,i,n,this.font_scale))}}]),e}(c),m=function(t){function e(){return a(this,e),n(this,Object.getPrototypeOf(e).apply(this,arguments))}return r(e,t),o(e,[{key:"initialize",value:function(){var t=this.conditions[0].color_scale,e=this.report_sel.node(),i=this.conditions[0].opacity;l.render_color_scale(e,t,this.description,i,this.font_scale)}}]),e}(c),v={cell:d,line:u,heatmap:h,toggle:p,report:f,table:_,legend:m};e.exports=s},{"./ssv_renderers.es6":4}],3:[function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=t("./ssv_controls.es6"),s=t("./ssv_elements.es6"),o=function(){function t(e,i,r,s,o,l,c){n(this,t),this.uuid=e,this.svg_sel=d3.select("#"+this.uuid+" #ssv-svg"),this.popover_div_sel=d3.select("#"+e+" .popover-spacer"),this.info_layer_sel=d3.select("#"+this.uuid+" #info-layer"),this.svg_container_sel=d3.select("#"+this.uuid+" .ssv-visual"),this.svg_container_sel.style("font-size",c.toString()+"px"),this.svg_sel.style("font-size",c.toString()+"px"),this.elements=[],this.svg_overlays=l,this.initialize_overlays(),this.set_font_scale(),this.initialize_elements(o),a(e,i,r,s,this.update_elements,this)}return r(t,[{key:"initialize_overlays",value:function(){this.svg_sel.select("defs").empty()&&this.svg_sel.append("defs");for(var t in this.svg_overlays)this.svg_sel.select("defs").html(this.svg_sel.select("defs").html()+this.svg_overlays[t])}},{key:"set_font_scale",value:function(){var t=parseFloat(this.svg_sel.attr("viewBox").split(" ")[3])/this.svg_container_sel.node().getBoundingClientRect().height;this.font_scale=t,this.svg_sel.attr("font-scale",t)}},{key:"initialize_elements",value:function(t){var e=this.uuid,i=this.font_scale;this.elements=t.map(function(t){return s(e,t,i)}),this.update_elements(0)}},{key:"update_elements",value:function(t,e){this.elements.map(function(i){i.update(t,e)})}}]),t}();window.onerror=function(t){d3.select("body").attr("JSError",t)};var l={};e.exports={add_element_context:function(t){for(var e=arguments.length,i=Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];l[t]=new(Function.prototype.bind.apply(o,[null].concat([t],i)))}}},{"./ssv_controls.es6":1,"./ssv_elements.es6":2}],4:[function(t,e,i){"use strict";function n(t,e,i,n){if(t){var r=d3.select(t.parentNode),a=t.getBBox(),s=a.width,o=a.x,l=a.y,c=1.2,u=1,h=.1,p="#FFC107",f="#00BFA5",_="#FFFFFF",m="#FFFFFF",v="#FFEB3B",y="#616161",g="Sizing...";d3.select(t).style("visibility","hidden");var x=r.append("g").attr("transform","translate("+o+","+l+")").append("g").attr("id","ssv-report").attr("font-size",e.toString()+"em"),b=x.append("rect").attr("width",s).attr("fill",y).attr("fill-opacity","1").attr("text-anchor","middle").attr("alignment-baseline","after-edge"),w=x.append("text").attr("width",s).attr("fill-opacity","1").attr("text-anchor","middle").attr("alignment-baseline","baseline").attr("x",s/2).attr("fill",p).style("font-size",c.toString()+"em").text(g),z=w.node().getBBox().height;w.attr("y",z*(1+h));var k=z*u/c,F=z*(1+2*h);b.attr("height",F);var B=k*(1+1*h),O=B+k*h;w.text(n);for(var S=0;S<i.length;S++){var A=i[S];if("report"in A&&A.report){var j=A.data,E=1;j[0].constructor===Array&&(E=j[0].length),x.append("rect").attr("width",s).attr("fill",y).attr("fill-opacity","1").attr("text-anchor","middle").attr("alignment-baseline","after-edge").attr("y",F).attr("height",(E+1)*O),x.append("text").attr("width",s).attr("fill-opacity","1").attr("text-anchor","middle").attr("alignment-baseline","after-edge").attr("x",s/2).attr("y",F+B).attr("fill",f).style("font-size",u.toString()+"em").attr("font-style","oblique").text(A.description);var C;C="section_label"in A&&""!=A.section_label?A.section_label:"Section",F+=O;for(var L=0;L<E;L++){var M;M=E>1?3:2,E>1&&x.append("text").attr("width",s).attr("fill-opacity","1").attr("text-anchor","middle").attr("alignment-baseline","after-edge").attr("x",s/(2*M)).attr("y",F+B).attr("fill",_).style("font-size",u.toString()+"em").text(C+" #"+(L+1).toString());var P;P=E>1?j.map(function(t){return d(t[L])}):j.map(function(t){return d(t)}),x.append("text").attr("width",s).attr("fill-opacity","1").attr("text-anchor","middle").attr("alignment-baseline","after-edge").attr("class","value-text").datum(P).attr("x",s/(2*(4-M))).attr("y",F+B).attr("fill",v).style("font-size",u.toString()+"em"),x.append("text").attr("width",s).attr("fill-opacity","1").attr("text-anchor","middle").attr("alignment-baseline","after-edge").attr("x",(2*M-1)*s/(2*M)).attr("y",F+B).attr("fill",m).style("font-size",u.toString()+"em").text(A.unit),F+=O}}}}var N=function(t){r.selectAll(".value-text").text(function(e){return e[t]})};return N}function r(t,e,i,n){var r=d3.select(t.parentNode);r.select("defs").empty()&&r.append("defs");var a=t.getBBox().height;i[0].length>1&&(i=i.map(function(t){return t.sort(function(t,e){return-(t[0]-e[0])})}));var i=i.map(function(t){return t.map(function(t){var e=Math.max(0,1-t[0])*a;return[e].concat(t.slice(1,t.length))})}),s=r.select("defs"),o=s.append("pattern").attr("id",e).attr("x",0).attr("y",0).attr("width","100%").attr("height","100%").attr("patternContentUnits","userSpaceOnUse").datum(i),l=o.selectAll().data(function(t){return t[0]}).enter();l.each(function(){o.append("rect").attr("id","base").attr("x","0").attr("width","100%").attr("height","100%"),o.append("rect").attr("id","transition").attr("x","0").attr("width","100%").attr("height","1px").attr("fill","#FFFFFF"),o.append("rect").attr("id","overlay").attr("x","0").attr("width","100%").attr("height","100%")});var c=d3.select(t);"fill"==n?c.style("fill","url(#"+e+")"):c.style("stroke","url(#"+e+")"),c.style("fill-opacity",1),c.style("opacity",1);var d=function(t,e){o.selectAll("#base").data(function(e){return e[t]}).transition().duration(e).attr("y",function(t){return t[0]}).style("fill",function(t){return t[1]}).style("opacity",function(t){return t[2]}),o.selectAll("#transition").data(function(e){return e[t]}).transition().duration(e).attr("y",function(t){return t[0]>0?t[0]:"-1%"}).style("opacity",function(t){return t[2]}),o.selectAll("#overlay").data(function(e){return e[t]}).transition().duration(e).attr("fill",function(t){return null==t[3]?"none":"url(#"+t[3]+")"}).attr("y",function(t){return t[0]}).style("opacity",function(t){return t[2]})};return d}function a(t,e,i,n){if(t){var r=d3.select(t.parentNode),a=t.getBBox(),s=d3.scaleLinear().domain([0,e[0][0].length]).range([0,a.width]),o=d3.scaleLinear().domain([0,e[0].length]).range([0,a.height]),l=r.append("g").attr("transform","translate("+a.x+","+a.y+")").append("g"),c=e.map(function(t){return t.map(function(t){return t.map(function(t){return i(t)})})});l.data([c]);var d=l.selectAll().data(function(t){return t[0]}).enter().append("g").attr("class","x_section").attr("stroke","black").attr("stroke-width","1px");d.selectAll(".bin").data(function(t){return t}).enter().append("rect").attr("class","bin").attr("x",function(t,e){return s(e)}).attr("width",function(t,e){return s(e+1)-s(e)}).style("fill",function(t){return t}).style("fill-opacity",function(){return n}).attr("height",a.height/e[0].length),d.each(function(t,e){d3.select(this).selectAll(".bin").attr("y",o(e))});var u=function(t,e){var i=r.select("g").select("g"),n=i.selectAll(".x_section").data(function(e){return e[t]});n.selectAll(".bin").data(function(t){return t}).transition().duration(e).style("fill",function(t){return t})};return u}}function s(t,e,i,n,r){if(t){var a=d3.select(t.parentNode),s=t.getBBox(),o=s.width,l=s.x,c=s.y;d3.select(t).style("visibility","hidden");var d=a.append("g").attr("transform","translate("+l+","+c+")").append("foreignObject").attr("id","ssv-table").attr("width",o).attr("height",500).append("xhtml:table").attr("class","table").attr("id",e).datum(i);d.append("thead").append("tr").selectAll().data(n).enter().append("th").text(function(t){return t}).style("font-size",r.toString()+"em"),d.append("tbody");var u=function(t){var e=d.selectAll(".content-row").data(function(e){return e[t]});e.exit().remove(),e.enter().append("tr").merge(e).attr("class","content-row");var i=d.selectAll(".content-row").selectAll(".content-cell").data(function(t){return t});i.exit().remove(),i.enter().append("td").merge(i).text(function(t){return t}).style("font-size",r.toString()+"em").attr("class","content-cell")};return u}}function o(t,e,i,n,r){if(t){var a=d3.select(t.parentNode);d3.select(t).style("visibility","hidden");var s=t.getBBox(),o=s.width,l=s.x,c=s.y,a=d3.select(t.parentNode),d=a.append("g").attr("transform","translate("+l+","+c+")").append("g").attr("font-size",r+"em").attr("stroke","black").attr("stroke-width","0.01em"),u=e.range().length,h=d3.scaleLinear().domain([0,u]).range([0,o]),p=1.5,f=1,_=.1,m=d.append("text").text(i).attr("x",o/2).attr("y","1em").attr("text-anchor","middle").attr("font-size",p.toString()+"em"),v=m.node().getBBox().height,y=d.selectAll("rect").data(e.range());y.enter().append("rect").attr("x",function(t,e){return h(e)}).attr("y",(1+_)*v).attr("width",function(t,e){return h(e+1)-h(e)}).attr("height",v).attr("fill",function(t){return t}).style("fill-opacity",n).attr("font-size",p.toString()+"em"),y.enter().append("text").text(function(t){return e.invertExtent(t)[0].toFixed(0)}).attr("x",function(t,e){return h(e)}).attr("y",v*(2+_+f/p*(1+_))).attr("text-anchor","middle").attr("font-size",f.toString()+"em")}}function l(t,e,i,n){var r=t.append("div").style("background","#9E9E9E"),a=[150,50];"dims"in i&&(a=i.dims);var s=r.append("svg").attr("width",a[0]+"px").attr("height",a[1]+"px").style("font-size",n.toString()+"em").append("g");if(r.attr("class","ssv-popover").style("visibility","hidden"),"sparkline"==i.type)var o=c(s,a,i.x_series,i.data,i.label);return e.map(function(t){t.on("mouseover",function(){r.style("visibility","visible")}),t.on("mousemove",function(){r.style("top",d3.event.pageY+"px").style("left",d3.event.pageX+"px")}),t.on("mouseout",function(){r.style("visibility","hidden")})}),o}function c(t,e,i,n,r){var a=e[0],s=e[1],o=.05*a,l=o,c=d3.line().x(function(t,e){return h(e)}).y(function(t){return p(t)});if(r){var d=t.append("text").attr("x",o).attr("y","1.05em").attr("fill","#FFFFFF").text(r),u=d.node().getBBox();l+=2*u.y+u.height}var h=d3.scaleLinear().range([0,a-2*o]),p=d3.scaleLinear().range([s-l-o,0]),f=t.append("g").attr("transform","translate("+o+","+l+")");h.domain([0,i.length]),p.domain([d3.min(n),d3.max(n)]),f.append("path").style("fill","none").style("stroke","#FFFFFF").style("stroke-width","0.1em").attr("d",c(n));var _=f.append("circle").attr("r","0.5em").attr("fill","orange"),m=function(t,e){_.transition().duration(e).attr("cx",h(t)).attr("cy",p(n[t]))};return m}var d=t("./ssv_utilities.es6").num_format;e.exports={render_report:n,render_pattern:r,render_color_scale:o,render_table:s,render_rect_heatmap:a,render_popover:l}},{"./ssv_utilities.es6":5}],5:[function(t,e,i){"use strict";function n(t){return t>=1e3||t<.01?d3.format(".2e")(t):d3.format(".2f")(t)}e.exports={num_format:n}},{}]},{},[3])(3)});
//# sourceMappingURL=maps/ssv.min.js.map
